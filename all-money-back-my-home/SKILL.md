---
name: all-money-back-my-home
description: 分析投研报告（支持 PDF/图片/Word 等多种格式），提取股票信息并生成结构化投资策略表格
---

## 目标

将任意投研机构的报告进行自动化分析，完成以下任务：

1. 提取报告中提及的所有股票名称
2. 识别每只股票的所属板块（根据上下文判断）
3. 根据报告措辞判断推荐等级
4. 提取核心推荐理由
5. 根据AI知识库补充对应的股票代码
6. 生成结构化的Markdown表格输出

## 支持格式

| 格式 | 扩展名 | 提取方式 |
|------|--------|----------|
| PDF | `.pdf` | pdftotext / PyPDF2 |
| Word | `.docx/.doc` | pandoc / python-docx |
| 图片 | `.png/.jpg/.webp` | **Agent 视觉能力直接分析，不要进行OCR操作！** |
| 纯文本 | `.txt/.md` | 直接读取 |
| HTML | `.html/.htm` | pandoc / w3m |

## 工作流

### Step 1: 内容提取（多格式支持）

**文本格式** (PDF/DOCX/TXT/HTML):

```bash
# 使用统一提取脚本
./scripts/extract_content.sh <file_path>
```

**图片格式** (PNG/JPG/WEBP):

```txt
# 直接将图片路径提供给 Agent，利用视觉能力分析
请分析 /path/to/report.png 中的股票
```

### Step 2: 股票信息识别

从文本中逐一识别：

- **股票名称**：识别中文上市公司名称
- **板块分类**：根据上下文语境判断所属行业/概念板块
- **推荐等级**：参考 `references/analysis_guidelines.md` 中的判断规则
- **推荐理由**：提取报告中对该股票的核心观点

### Step 3: 股票代码补充

根据AI知识库，为每只识别到的股票补充对应代码：

- A股沪市：`600xxx.SH` / `601xxx.SH` / `603xxx.SH` / `688xxx.SH`（科创板）
- A股深市：`000xxx.SZ` / `002xxx.SZ` / `300xxx.SZ`（创业板） / `301xxx.SZ`
- 港股：`xxxx.HK`
- 美股：`TICKER`

### Step 4: 过滤与排序（根据用户需求）

默认：

- 默认按A股市场的股票过滤
- 默认按推荐等级排序，

### Step 5: 输出生成

```markdown
## 📊 [报告标题] 推荐股票清单

| 股票名称 | 股票代码 | 板块 | 推荐等级 | 推荐理由 |
|---------|---------|------|---------|---------|
| ... | ... | ... | ... | ... |

> ⚠️ 以上信息仅为报告内容整理，不构成投资建议。
```

## 使用示例

```txt
请分析 /path/to/report.pdf 中的股票

分析这份投研报告，剔除港股，按推荐等级排序

帮我提取这个PDF里推荐的股票，只要A股
```
